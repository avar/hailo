#!/usr/bin/env perl
package hailo;
use 5.010;
use strict;
use parent 'Hailo';
use open qw< :encoding(utf8) :std >;
use Encode qw< decode >;
use Pod::Usage ();
use Getopt::Long::Descriptive;

my ($opt, $usage) = describe_options(
    __PACKAGE__ . ' %o',
    [ 'version|v',           'Print version and exit' ],
    [ 'ui|u',                'Use UI CLASS' ],
    [ 'train|t',             'Learn from all the lines in FILE, use - for STDIN' ],
    [ 'stats|s',             'Print statistics about the brain' ],
    [ 'reply|r',             'Reply to STRING' ],
    [ 'progress|p',          'Print import progress with Term::ProgressBar' ],
    [ 'order|o',             'Markov order' ],
    [ 'learn|l',             'Learn from STRING' ],
    [ 'help|h',              'This help message' ],
    [ 'brain|b',             'Load/save brain to/from FILE' ],
    [ 'autosave|a',          'Save the brain on exit (on by default)' ],
    [ 'tokenizer|T',         'Use tokenizer CLASS' ],
    [ 'storage|S',           'Use storage CLASS' ],
    [ 'learn-reply|L',       'Learn from STRING and reply to it' ],
    [ 'engine|E',            'Use engine CLASS' ],
    [ 'ui-args',              'Arguments for the UI class' ],
    [ 'tokenizer-args',       'Arguments for the Tokenizer class' ],
    [ 'storage-args',         'Arguments for the Storage class' ],
    [ 'examples',             'Print examples along with the help message' ],
    [ 'engine-args',          'Arguments for the Engine class' ],
    [ 'brain-resource',       'Alias for `brain\' for backwards compatability' ],
);

print($usage->text), exit if $opt->help;

help() unless @ARGV;

# use utf8 everywhere
$_ = decode('utf8', $_) for @ARGV;

# Set programname
$0 = __PACKAGE__;

if ($^O eq 'linux') {
    local $@;
    eval {
        require Sys::Prctl;
        Sys::Prctl::prctl_name(__PACKAGE__);
    };
}

# Show help if run without arguments
@ARGV = qw(--help) unless @ARGV;

sub help
{
    my %arg = @_;
 
    Pod::Usage::pod2usage(
        -verbose => $arg{ verbose },
        -exitval => $arg{ exitval } || 0,
    );
}

=head1 NAME

hailo - Command-line interface to the L<Hailo|Hailo> Markov engine

=head1 DESCRIPTION

See the documentation for L<Hailo|Hailo> for more information.

=head1 AUTHOR

E<AElig>var ArnfjE<ouml>rE<eth> Bjarmason <avar@cpan.org>

=head1 LICENSE AND COPYRIGHT

Copyright 2010 E<AElig>var ArnfjE<ouml>rE<eth> Bjarmason <avar@cpan.org>

This program is free software, you can redistribute it and/or modify
it under the same terms as Perl itself.

=cut
